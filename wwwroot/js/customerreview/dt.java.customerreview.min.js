function AlignThankMess(n){$("#bgshow").show();var t=$("#"+n+"").width(),i=$("#"+n+"").outerWidth(),r=(t+(i-t))/2;$("#"+n+"").show().css("left","50%");$("#"+n+"").show().css("margin-left","-"+i/2+"px");$("#"+n+"").show().css("top","200px");$("#"+n+"").show()}function HideThankMess(n){$("#bgshow").hide();$("#"+n+"").hide()}function CustomValidatorClientValidate(){return!1}function CustomTextValidatorClientValidate(n,t){var i=$("#revContent").val();i.length<15?(t.IsValid=!1,$("html, body").scrollTop(0)):t.IsValid=!0}function CustomExpValidatorClientValidate(n,t){var i=$("#opVal").val(),r=$("ul.options li.unselectedItem").length;i==-1||r==5?(t.IsValid=!1,$("html, body").scrollTop(0)):t.IsValid=!0}function webServiceConnection(){AlignThankMess("dvAjax");$("html, body").scrollTop(0);var n=$("#formAjax").serializeObject(),t=getFormData($("#formAjax"));$.ajax({url:"/Api/GetReview",data:JSON.stringify(n),contentType:"application/json",type:"POST",success:function(n){n==="Success"?webServiceSuccess(t):webServiceFail()},error:function(n){alert(n.responseText)}})}function webServiceFail(){HideThankMess("dvAjax");$(".dvMainContainer").hide();$("#errMess").length===0?$(dvError).insertAfter($("#dvAjax")):""}function webServiceSuccess(n){HideThankMess("dvAjax");AlignThankMess("dvThank");$("#rateOverall").hide();$("#valYN").hide();$("#topText").hide();$("#topLbl").show();$("#ulExperienceOptions").hide();$("#dvExp").length===0?($(dvExp).insertAfter($("#ulExperienceOptions")),$("#Li"+n.userRate+"").toggleClass("unselectedItemSel selectedItem")):"";$("#ulUse").hide();$("#dvUse").length===0?($(dvUse).insertAfter($("#valYN")),$("#useLbl").html(n.userUsing!=1?"No":"Yes")):"";$("#revContent").hide();$(dvRev).insertAfter($("#revContent"));$("#dvRevContentReadOnly").html(n.userReview);$("#dvUserSelect").hide();$("#submitBotton").hide();$("#dvLinks").length===0?$("#dvLinksJS").show():"";$("#dvPreSelect").length===0?$(dvPre).insertBefore($("#dvUsMoreLine")):"";$.each(n,function(n,t){var u="",r="",i=0;switch(n){case"serviceScore":r="Customer service";i=1;break;case"sitebpScore":r="Website";i=2;break;case"flightScore":r="Flights";i=3;break;case"hotelScore":r="Hotels";i=4;break;case"transferScore":r="Transfers";i=5;break;case"ssScore":r="Activities";i=6;break;case"carrentalScore":r="Car Rentals";i=7;break;case"trainScore":r="Trains";i=8;break;case"ferryScore":r="Ferries";i=9}if(i>0&&t!="N/A"){for(u='<div class="dvEachSrvc" style="padding-left:10px; margin:0px 10px; height:46px;"><div style="color:#ec7f15;float:left;padding:14px 0px 0px 10px;">&#9632;&nbsp;&nbsp;<\/div><div style="width:250px;float:left;padding:15px 0px 0px 4px;">'+r+'<\/div><div id="container_'+i+'_PreSelected" class="ServiceContainer-preselected">',j=1;j<=5;j++)u=j<=t?u+'<div class="star-rating-selected" title="'+j+'"><\/div>':u+'<div class="star-rating-preselected" title="'+j+'"><\/div>';u=u+'<\/div><div style="float:left;margin-left:10px;color:#929191;padding:15px 0px 0px 0px;">('+t+' out of 5)<\/div><div style="float:left;margin-left:20px;padding:15px 0px 0px 0px;"><span class="'+rates[Number(t-1)].className+'">'+rates[Number(t-1)].label+'<\/span><\/div><div style="clear:both;"><\/div><\/div>'}$("#dvPreSelect").append(u)});$("#dvStatusJS").css("display","block");$("#feedReceived").val("True")}function getFormData(n){var i=n.serializeArray(),t={};return $.map(i,function(n){t[n.name]=n.value}),t}var containerName="ctl00_ContentPlaceHolder1_",rates=[{label:"Dissatisfied",className:"disatisfied"},{label:"Somewhat Dissatisfied",className:"some_satisfied"},{label:"Somewhat Satisfied",className:"satisfied"},{label:"Satisfied",className:"satisfied"},{label:"Completely Satisfied",className:"satisfied"}],dvError;$(document).ready(function(){var t,n;$(".star-rating").mouseover(function(){var n=$(this).attr("id").split("_")[1],t=$(this).attr("id").split("_")[2];for(i=1;i<=5;i++)i<=t?$("#s_"+n+"_"+i).hasClass("star-rating-selected")||$("#s_"+n+"_"+i).addClass("star-rating-selected"):$("#s_"+n+"_"+i).hasClass("star-rating-selected")&&$("#s_"+n+"_"+i).removeClass("star-rating-selected");$("#rate_"+n+"_descr").show().text("("+t+" out of 5)");$("#rate_"+n+"_descrFull").show().html('<span class="'+rates[t-1].className+'">'+rates[t-1].label+"<\/span>")}).on("click touchend",function(){var t=$(this).attr("id").split("_")[1],n=$(this).attr("id").split("_")[2];$("#rate_"+t).val(n);switch(t){case"1":$("#serviceScore").val(n);break;case"2":$("#sitebpScore").val(n);break;case"3":$("#flightScore").val(n);break;case"4":$("#hotelScore").val(n);break;case"5":$("#transferScore").val(n);break;case"6":$("#ssScore").val(n);break;case"7":$("#carrentalScore").val(n);break;case"8":$("#trainScore").val(n);break;case"9":$("#ferryScore").val(n)}});for($(".ServiceContainer").mouseout(function(){var n=$(this).attr("id").split("_")[1],t=$("#rate_"+n).val();for(i=1;i<=5;i++)i<=t?$("#s_"+n+"_"+i).hasClass("star-rating-selected")||$("#s_"+n+"_"+i).addClass("star-rating-selected"):$("#s_"+n+"_"+i).hasClass("star-rating-selected")&&$("#s_"+n+"_"+i).removeClass("star-rating-selected");t==0?($("#rate_"+n+"_descr").hide(),$("#rate_"+n+"_descrFull").hide()):($("#rate_"+n+"_descr").text("("+t+" out of 5)"),$("#rate_"+n+"_descrFull").html('<span class="'+rates[t-1].className+'">'+rates[t-1].label+"<\/span>"))}),$("ul.usingAgain li").click(function(){$("ul.usingAgain li").removeClass("selectedItem").addClass("unselectedItem");$(this).removeClass("unselectedItem").addClass("selectedItem");var n=$(this).attr("id").replace("u","");$("#"+containerName+"usingVal").val(n);$("#userUsing").val(n)}),$("ul.options li").click(function(){$("ul.options li").removeClass("selectedItem").addClass("unselectedItem");$(this).removeClass("unselectedItem").addClass("selectedItem");var n=$(this).attr("id").replace("o","");$("#opVal").val(n);$("#opVal_Descr").val($(this).text());$("#userRate").val(n)}),$("#feedRcvd").val()=="True"&&($("#submitBotton").hide(),AlignThankMess("dvThank")),t=$("#opVal").val(),$('#ulExperienceOptions li[id^="o'+t+'"]').removeClass("unselectedItem").addClass("selectedItem"),$('#ulExperienceOptionsSel li[id^="Li'+t+'"]').removeClass("unselectedItemSel").addClass("selectedItemSel"),i=1;i<=9;i++){if(n=$("#rate_"+i).val(),n==undefined)break;if(n!=0){for(j=1;j<=n;j++)$("#s_"+i+"_"+j).addClass("star-rating-selected");$("#rate_"+i+"_descr").show().text("("+n+" out of 5)");$("#rate_"+i+"_descrFull").show().html('<span class="'+rates[n-1].className+'">'+rates[n-1].label+"<\/span>")}else $("#rate_"+i+"_descr").hide(),$("#rate_"+i+"_descrFull").hide()}$("#submitBotton").on("click touchend",function(){var n=0,t=0;$(".unselectedItem").length===7?($("#valYN").show(),$("#rateOverall").show(),$("html, body").scrollTop(0)):$(".selectedItem").each(function(){this.id.indexOf("u")>-1?n=1:"";this.id.indexOf("o")>-1?t=1:""});n===1&&t===1?($("#userReview").val($("#revContent").val()),webServiceConnection()):(n===1?$("#valYN").hide():($("#valYN").show(),$("html, body").scrollTop(0)),t===1?$("#rateOverall").hide():($("#rateOverall").show(),$("html, body").scrollTop(0)))})});dvError='<div ID="dvErrMess" visible="false" style="padding:20px 0px;"><div style="margin:0 auto; border:solid 1px #ccc; padding:30px; font-family:Arial, Helvetica, sans-serif; max-width:640px;"><p><img src="https://pictures.tripmasters.com/siteassets/d/TM_Header.png" alt="TripMaster.com"/><\/p><div ID="dvLblErr" style="color:#006;font-size:18px">We are sorry that we are unable to save your review at this time.<\/div><\/div><\/div>';var dvExp='<div id="dvExp" style="padding:30px 0px 40px 10px;"><ul id="ulExperienceOptionsSel" class="options"><li id="Li5" class="unselectedItemSel">Completely Satisfied<\/li><li id="Li4" class="unselectedItemSel">Satisfied<\/li><li id="Li3" class="unselectedItemSel">Somewhat Satisfied<\/li><li id="Li2" class="unselectedItemSel">Somewhat Dissatisfied<\/li><li id="Li1" class="unselectedItemSel">Dissatisfied<\/li><\/ul><\/div>',dvUse='<div id="dvUse" style="display:inline;padding:0px 0px 0px 30px;"><img align="absmiddle" style="border-width:0px;border:none;" src="https://pictures.tripmasters.com/siteassets/d/checkmark.png"><span id="useLbl" class="txt_boldBlack14"><\/span><\/div>',dvRev='<div style="height:235px;width:900px;margin:25px 0px 0px 10px;border:none;" id="dvRevContentReadOnly"><\/div>',dvPre='<div id="dvPreSelect"><\/div>';$.fn.serializeObject=function(){var n={},t=this.serializeArray();return $.each(t,function(){n[this.name]?(n[this.name].push||(n[this.name]=[n[this.name]]),n[this.name].push(this.value||"")):n[this.name]=this.value||""}),n};