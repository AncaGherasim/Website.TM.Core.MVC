function callAgent(n,t,i){$.ajax({type:"POST",url:"/Api/CallCustomer",contentType:"application/json; charset=utf-8",data:'{"email":"'+n+'", "phone":"'+t+'", "name":"'+i+'"}',success:function(n){var t=JSON.parse(n);t.statusCode===200&&($(".online").hide(),$(".notAvailable").hide(),$(".notAvailableOn").hide(),$(".done").show(),waitCall=1,$("#phoneCust").val(""))},error:function(n){alert(n.responseText+" = error")}})}function checkStatus(){var n=window.location.search.split("&"),t=n[0].substr(n[0].indexOf("=")+1),i=n[1].match(isNumber);$.ajax({type:"POST",url:"/Api/CheckStatus",contentType:"application/json; charset=utf-8",data:'{"email":"'+t+'", "id":'+i+"}",success:function(n){console.log(n);var t=n[0].agentStatus,i=n[0].contactType,r=n[0].activeChats;console.log(i+" | "+r);t=="Available"&&i=="chat"&&(t="OnChat");switch(t){case"Available":$(".spStatus").text(t);$(".spStatus").removeClass("offline");$(".spStatus").addClass("available");$(".notAvailableOn").hide();$(".notAvailable").hide();waitCall===1?"":($(".done").hide(),$(".online").show());break;case"Busy":$(".spStatus").text("Not available (on a call)");$(".spStatus").removeClass("offline");$(".spStatus").removeClass("available");$(".spStatus").addClass("offline");$(".online").hide();waitCall===1?"":($(".done").hide(),$(".notAvailableOn").show(),$(".notAvailable").hide());break;case"OnChat":$(".spStatus").text("Not available (on a chat)");$(".spStatus").removeClass("offline");$(".spStatus").removeClass("available");$(".spStatus").addClass("offline");$(".online").hide();waitCall===1?"":($(".done").hide(),$(".notAvailableOn").show().html($(".notAvailableOn").html().replace("another call","a chat")),$(".notAvailable").hide());break;default:waitCall=0;$(".spStatus").text("Not available");$(".spStatus").removeClass("offline");$(".spStatus").removeClass("available");$(".spStatus").addClass("offline");$(".online").hide();$(".done").hide();$(".notAvailableOn").hide();$(".notAvailable").show()}},error:function(){}})}function phoneMask(){var n=$("#phoneCust").val().replace(/\D/g,""),t="-",i=") ";n.length<3&&(i="");n.length<6&&(t="");$("#phoneCust").val("("+n.substring(0,3)+i+n.substring(3,6)+t+n.substring(6,10))}var isNumber=/[0-9]+/g,interval,waitCall=0;$(document).ready(function(){var n=new RegExp(/^\(?(\d{3})\)?[-\. ]?(\d{3})[-\. ]?(\d{4})( x\d{4})?$/g),t=$("#agtStatus").val();$('[type="tel"]').keyup(function(n){n.keyCode!==8&&phoneMask(this)});$(".btnCall").click(function(){var t=window.location.search.split("&"),f=t[0].substr(t[0].indexOf("=")+1),i=$("#phoneCust").val(),r,u;n.test(i)&&(r=i.replace(/[^0-9.]/g,""),u=$("#agtName").val(),callAgent(f,r,u))});$(".spExpand").click(function(){$(".dvSchedule").is(":visible")==!0?($(".spExpand").removeClass("collapsed"),$(".dvSchedule").hide()):($(".spExpand").addClass("collapsed"),$(".dvSchedule").show())});validation=="True"&&(interval=setInterval(function(){checkStatus()},9e3))});