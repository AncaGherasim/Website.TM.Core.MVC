function buildRecentlyViewed(n){const t=n.map(function({UTS_Site:e,STR_PlaceTitle:u,PDL_Title:r,PDLID:t,IMG_Path_URL:n,feedbacks:o,PDL_Content:i,UTS_Date:f}){return`<div class="dvImage">
			     <a href="${getSiteURL(e)}/${getReplaceStr(u)}/${getReplaceStr(r)}/package-${t}">
                   <img src="https://pictures.tripmasters.com${n.toLowerCase()}"/>
                 </a>
                </div>
				<div class="dvInfo">
			      <div class="dvInfoTitle" id="pos${t}">
			        <a href="${getSiteURL(e)}/${getReplaceStr(u)}/${getReplaceStr(r)}/package-${t}">
                      ${r}
				    </a>
                  </div>
				  <div class="dvDetails">
				    <div style="font-weight:bold; padding:3px 0px 0px 0px; color:#333; font-size:12px; text-align:left;">
                      Itinerary includes:
                    </div>
				    <div>
				      <ul style="padding:3px 12px; margin:0px; font-size:12px; color:#666; text-align:left;">
                        ${i.split("\r\n").map(n=>`<li>${n}</li>`).join("")}
                      </ul>
				    </div>
				  </div>
			    </div>
				<div class="dvButton">
				  <div class="dvViewed">Viewed ${getVisitTime(f)}</div>
                  ${o>0?`<div class="dvViewed">
				                       <a href="${getSiteURL(e)}/${getReplaceStr(u)}/${getReplaceStr(r)}/feedback-${t}">
                                         ${o} Travelers reviewed this package
                                       </a>
				                     </div>`:""}
                  <div style="padding:10px 0; margin-left:60px">
				    <a class="customize" href="${getSiteURL(e)}/${getReplaceStr(u)}/${getReplaceStr(r)}/package-${t}">
                      Customize It
			        </a>
                  </div>
                </div>
                <div style="clear:both;"></div>
                <hr class="gradLineTop"/>`}).join(""),i=`<div id="pagDV1" class="dvEachVis">
                      ${t}
                      </div>`;$("div .dvItemsContainer").append(i)}function createButtonMore(){const n=`<div class="dvViewDisplayMore" id="displayMore">
		              <button onclick="fetchNextRecentlyViewed()"> ${perpage} More recently Viewed Packages</button>
		            </div>`;$(".dvRoundContainer").append(n)}function getSiteURL(n){let t;switch(n){case"TMED":t="/europe";break;case"TMASIA":t="/asia";break;case"TMLD":t="/latin"}return t}function getVisitTime(n){const t=Date.parse(n),i=new Date(t),r=new Date;return timeBetween(i,r)}function getReplaceStr(n){return n.replace(/ /g,"_")}function fetchNextRecentlyViewed(){$.ajax({url:"/Api/RecentlyViewed",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({Name:utVisitorID}),type:"POST",success:function(n){console.log("Api/RecentlyViewed: ");console.log(n);const r=n.length,u=nextPage*perpage,t=nextPage*perpage+perpage;buildRecentlyViewed(n.slice(u,t));t>=r&&$(".dvViewDisplayMore").hide();const i=r-t;i<perpage&&$(".dvViewDisplayMore button").html(`${i} More recently Viewed ${i===1?"Package":"Packages"}`);nextPage++},error:function(n){console.log(n)}})}var fileVersion=8012022,utVisitorID=-1,visitID;const perpage=10;let nextPage=1;$(document).ready(function(){if(Cookies.get("ut2")!=undefined){var n=Cookies.get("ut2").split("&"),t=n[0].split("=");visitID=t[1]}else _ut2Functions.push(function(){utValues=_ut2;jQuery.each(utValues,function(n,t){n=="_utvId"&&(visitID=t)})});utVisitorID=visitID;console.log("recently utVisitorID: ");console.log(utVisitorID);$.ajax({url:"/Api/RecentlyViewed",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({Name:utVisitorID}),type:"POST",success:function(n){console.log("Api/RecentlyViewed: ");console.log(n);let t=0;if(n?t=n.length:"",$("#novisited").text(t),t>0){if(buildRecentlyViewed(n.slice(0,perpage)),t>perpage){createButtonMore();const n=t-perpage;n<perpage&&$(".dvViewDisplayMore button").html(`${n} More recently Viewed ${n===1?"Package":"Packages"}`)}}else $(".dvRoundContainer").append("<p style='text-align:center;font-size:15px;color:#666;'>You don't have any recent views<\/p>")},error:function(n){console.log(n)}})});