function addSubscribe(n){var t,i,r;$("#pnlSubscribe").hide();t=$.trim(n);t===""?t=$("#TMSubscribeEmail").val():"";i=1;r=0;$.ajax({type:"POST",url:"/WS_Library.asmx/wsmrktEmail",contentType:"application/json; charset=utf-8",dataType:"json",data:'{email:"'+t+'", ED:"'+r+'", TM:"'+i+'", proc:"1", options: ""}',success:function(n){var t=eval("("+n.d+")");/ok/.test(t)===!1?$("#pnlResult").html($("#pnlResult").html().replace("We have updated your subscription preferences.","Something went wrong, please try again later.")):"";$("#pnlResult").show()},error:function(){$("#pnlResult").html($("#pnlResult").html().replace("We have updated your subscription preferences.","Something went wrong, please try again later."));$("#pnlResult").show()}})}function getSubscribe(n){var t=$.trim(n);if(t===""?t=$.trim($("#SubscribedEmail").val()):"",t=decodeURIComponent(t),/%40/.test(t)?t=t.replace(/%40/,"@"):"",!isValidEmailAddress(t))return $("#SubscribedEmail").val("Valid email please"),$("#SubscribedEmail").focus().select(),!1;$.ajax({type:"POST",url:"/WS_Library.asmx/wsmrktEmail",contentType:"application/json; charset=utf-8",dataType:"json",data:'{email:"'+t+'", ED:"", TM:"", proc:"3", options: ""}',success:function(n){var t=eval("("+n.d+")");console.log(/[0-1]+/g.test(t));console.log(t.match(/[0-1]+/g));/[1]+/g.test(t)?(/ED/.test(t)?($("#SubscribeED").prop("checked",!0),$("#TxtSubsED").text("Subscribed")):($("#UnsubscribeED").prop("checked",!0),$("#TxtUnSubsED").text("Unsubscribed")),/TM/.test(t)?($("#SubscribeTM").prop("checked",!0),$("#TxtSubsTM").text("Subscribed")):($("#UnsubscribeTM").prop("checked",!0),$("#TxtUnSubsTM").text("Unsubscribed"))):($("#UnsubscribeED").prop("checked",!0),$("#TxtUnSubsED").text("Unsubscribed"),$("#UnsubscribeTM").prop("checked",!0),$("#TxtUnSubsTM").text("Unsubscribed"))},error:function(n){console.log(n.responseText)}})}function updateSubscribe(){var n=getUrlVars().email,l;n=decodeURIComponent(n);/%40/.test(n)?n=n.replace(/%40/,"@"):"";var i=0,r=0,u=0,f=0,e=0,o=0,s=0,h=0,c="...",t=$("#Ideas").val();$("#SubscribeTM").is(":checked")?i=1:"";$("#SubscribeED").is(":checked")?r=1:"";$("#UnsubscribeTM").is(":checked")?u=1:"";$("#UnsubscribeED").is(":checked")?f=1:"";$("#R1").is(":checked")?e=1:"";$("#R2").is(":checked")?o=1:"";$("#R3").is(":checked")?s=1:"";$("#R4").is(":checked")?(h=1,c=$("#txtOtherReason").val()):"";t=t===""?"...":$("#Ideas").val();l=f+"@"+u+"@"+e+"@"+o+"@"+s+"@"+h+"@"+c+"@"+t;$.ajax({type:"POST",url:"/WS_Library.asmx/wsmrktEmail",contentType:"application/json; charset=utf-8",dataType:"json",data:'{email:"'+n+'", ED:"'+r+'", TM:"'+i+'", proc:"2", options: "'+l+'"}',success:function(n){var t=eval("("+n.d+")");$("#pnlSubscribe").hide();$("#pnlReason").hide();$("#pnlResult").show()},error:function(n){alert(n.responseText)}})}function centerPopup(){var n=$(window).width(),t=$(window).height(),i=$("#subscriptionpopup").height(),r=$("#subscriptionpopup").width();return $("#subscriptionpopup").css({position:"absolute",top:t/2-i/2+$(window).scrollTop(),left:n/2-r/2}),!1}function loadPopup(){popupStatus==0&&($("#subscriptionpopup").fadeIn("slow"),popupStatus=1)}function disablePopup(){return $(".subscriptionpopup").is(":visible")==!0?($("#subscriptionpopup").fadeOut("slow"),popupStatus=0):"",!1}function isValidEmailAddress(n){var t=new RegExp(/^(("[\w-+\s]+")|([\w-+]+(?:\.[\w-+]+)*)|("[\w-+\s]+")([\w-+]+(?:\.[\w-+]+)*))(@((?:[\w-+]+\.)*\w[\w-+]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][\d]\.|1[\d]{2}\.|[\d]{1,2}\.))((25[0-5]|2[0-4][\d]|1[\d]{2}|[\d]{1,2})\.){2}(25[0-5]|2[0-4][\d]|1[\d]{2}|[\d]{1,2})\]?$)/i);return t.test(n)}function SubscribeEmailPopUp(n){var i=$("#"+n+"").val(),t;if(!isValidEmailAddress(i))return t=navigator.userAgent.match(/iPad/i)!=null,t==!0?($("#"+n+"").val(""),$("#"+n+"").focus().select(),alert("Valid email please")):($("#"+n+"").val("Valid email please"),$("#"+n+"").focus().select()),!1;$("#"+n).val($("#"+n).val());centerPopup();popupStatus==0&&($("#subscriptionpopup").fadeIn("slow"),addSubscribe(),popupStatus=1)}function unSubscribeReason(){if($("#UnsubscribeTM").is(":checked")||$("#UnsubscribeED").is(":checked"))$("#pnlSubscribe").hide(),$("#pnlReason").show(),$("#pnlResult").hide();else{var n=new URLSearchParams(window.location.search);addSubscribe(n.get("email"))}}function getUrlVars(){for(var t=[],n,r=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<r.length;i++)n=r[i].split("="),t.push(n[0]),t[n[0]]=n[1];return t}var popupStatus=0;$(document).ready(function(){$("#subscriptionpopup").hide();$("#pnlResult").hide();$("#SubscribeSubmit").click(function(){addSubscribe()});$("#FindSubscription").click(function(){getSubscribe()});$("#SubmitReasons").click(function(){unSubscribeReason()});$("#UpdateSbscriptionButton").click(function(){updateSubscribe()});$("#SubscribeAll").click(function(){$("#SubscribeAll").is(":checked")?($("#SubscribeED").attr("checked",!0),$("#SubscribeTM").attr("checked",!0)):($("#SubscribeED").attr("checked",!1),$("#SubscribeTM").attr("checked",!1))});$("#UnsubscribeAll").click(function(){var n=$("#UnsubscribeAll").is(":checked");$("#UnsubscribeAll").is(":checked")?($("#UnsubscribeED").attr("checked",!0),$("#UnsubscribeTM").attr("checked",!0)):($("#UnsubscribeED").attr("checked",!1),$("#UnsubscribeTM").attr("checked",!1))});$("#UnsubscribeED").click(function(){$("#SubscribeED").attr("checked",!1);$("#TxtSubsED").text("Subscribe")});$("#UnsubscribeTM").click(function(){$("#SubscribeTM").attr("checked",!1);$("#TxtSubsTM").text("Subscribe")});$("#SubscribeED").click(function(){$("#UnsubscribeED").attr("checked",!1);$("#TxtUnSubsED").text("Unsubscribe")});$("#SubscribeTM").click(function(){$("#UnsubscribeTM").attr("checked",!1);$("#TxtUnSubsTM").text("Unsubscribe")});$("#SubscribeMainSite").click(function(n){return n.preventDefault(),$("#subscriptionpopup").hide(),!1});$(".subscriptionpopupClose").click(function(){return disablePopup(),!1})});